const mobileMenuBtn=document.getElementById("mobileMenuBtn"),mobileMenu=document.getElementById("mobileMenu");mobileMenuBtn.addEventListener("click",(()=>{mobileMenu.classList.toggle("active")}));const mobileLinks=document.querySelectorAll(".nav-link-mobile");function scrollToSection(e){const t=document.getElementById(e);if(t){const e=document.getElementById("header").offsetHeight,n=t.offsetTop-e;window.scrollTo({top:n,behavior:"smooth"})}}mobileLinks.forEach((e=>{e.addEventListener("click",(()=>{mobileMenu.classList.remove("active")}))}));const observerOptions={threshold:.1,rootMargin:"0px 0px -50px 0px"},observer=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(e.target.style.opacity="1",e.target.style.transform="translateY(0)")}))}),observerOptions),animatedElements=document.querySelectorAll(".feature-card, .product-card, .gallery-item, .contact-info-card");animatedElements.forEach((e=>{e.style.opacity="0",e.style.transform="translateY(20px)",e.style.transition="opacity 0.6s ease, transform 0.6s ease",observer.observe(e)})),window.addEventListener("scroll",(()=>{const e=document.getElementById("header");window.scrollY>50?e.style.background="rgba(252, 250, 248, 0.95)":e.style.background="rgba(252, 250, 248, 0.8)"}));const modalOverlay=document.getElementById("modalOverlay"),modalWindow=document.querySelector(".modal-window"),modalCloseBtn=document.getElementById("modalClose"),modalActionBtn=document.getElementById("modalBtn"),modalTitle=document.getElementById("modalTitle"),modalMessage=document.getElementById("modalMessage"),modalIcon=document.getElementById("modalIcon"),iconSuccess='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>',iconError='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>';function showModal(e,t,n){modalWindow.classList.remove("success","error"),modalTitle.textContent=t,modalMessage.textContent=n,"success"===e?(modalWindow.classList.add("success"),modalIcon.innerHTML=iconSuccess,modalActionBtn.textContent="Отлично"):(modalWindow.classList.add("error"),modalIcon.innerHTML=iconError,modalActionBtn.textContent="Закрыть"),modalOverlay.classList.add("active")}function closeModal(){modalOverlay.classList.remove("active")}modalCloseBtn.addEventListener("click",closeModal),modalActionBtn.addEventListener("click",closeModal),modalOverlay.addEventListener("click",(e=>{e.target===modalOverlay&&closeModal()})),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("contactForm"),t=document.getElementById("name"),n=document.getElementById("phone"),o=document.getElementById("email"),s=document.getElementById("message"),r=document.querySelector(".char-count");function l(e,t){const n=document.getElementById(e.name+"-error"),o=e.closest(".form-group");n.textContent=t,o.classList.add("error"),e.classList.add("error-input")}function c(e){const t=document.getElementById(e.name+"-error"),n=e.closest(".form-group");t.textContent="",n.classList.remove("error"),e.classList.remove("error-input")}function a(){const e=t.value.trim();return""===e?(l(t,"Пожалуйста, введите ваше имя."),!1):/^[\p{L}\s'-]+$/u.test(e)?e.length>50?(l(t,"Слишком длинное имя."),!1):(c(t),!0):(l(t,"Имя может содержать только буквы."),!1)}function i(){const e=n.value.trim();return""===e?(l(n,"Пожалуйста, введите телефон."),!1):/^[\d\s\+\-\(\)]{10,20}$/.test(e)?(c(n),!0):(l(n,"Введите корректный номер."),!1)}function d(){const e=o.value.trim();return""===e||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?(c(o),!0):(l(o,"Некорректный email."),!1)}function m(){const e=s.value.length;r.textContent=`${e} / 200`}t.addEventListener("input",(()=>{t.classList.contains("error-input")&&a()})),n.addEventListener("input",(()=>{n.classList.contains("error-input")&&i()})),o.addEventListener("input",(()=>{o.classList.contains("error-input")&&d()})),s.addEventListener("input",m),e.addEventListener("submit",(function(r){r.preventDefault();const l=a(),c=i(),u=d();if(l&&c&&u){const r=e.querySelector('button[type="submit"]'),l=r.textContent;r.disabled=!0,r.textContent="Отправка...";const c={name:t.value.trim(),phone:n.value.trim(),email:o.value.trim(),message:s.value.trim()};fetch("send-order.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}).then((async t=>{const n=await t.json();if(!n.success)throw new Error(n.error||"Ошибка сервера");showModal("success","Заказ отправлен!","Спасибо! Мы свяжемся с вами в ближайшее время."),e.reset(),m(),document.querySelectorAll(".form-group").forEach((e=>e.classList.remove("error"))),document.querySelectorAll(".error-input").forEach((e=>e.classList.remove("error-input")))})).catch((e=>{showModal("error","Ошибка отправки","Не удалось отправить заказ. Попробуйте позже или позвоните нам.")})).finally((()=>{r.disabled=!1,r.textContent=l}))}})),m()})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".gallery-item"),t=document.getElementById("lightbox"),n=document.getElementById("lightboxImage"),o=document.getElementById("lightboxClose"),s=document.getElementById("lightboxPrev"),r=document.getElementById("lightboxNext");let l=0;const c=[];function a(){n.classList.remove("visible"),t.classList.remove("active"),document.body.style.overflow="",setTimeout((()=>{n.src=""}),300)}function i(e){n.classList.remove("visible"),n.style.transform="next"===e?"translateX(-50px) scale(0.95)":"translateX(50px) scale(0.95)",n.style.opacity="0",setTimeout((()=>{l="next"===e?(l+1)%c.length:(l-1+c.length)%c.length,n.src=c[l],n.style.transition="none",n.style.transform="next"===e?"translateX(50px) scale(0.95)":"translateX(-50px) scale(0.95)",n.offsetWidth,n.style.transition="transform 0.4s ease, opacity 0.4s ease",n.style.transform="translateX(0) scale(1)",n.style.opacity="1",n.classList.add("visible")}),300)}e.forEach(((e,o)=>{const s=e.querySelector("img");s&&(c.push(s.src),e.addEventListener("click",(()=>{l=o,function(e){n.src=c[e],t.classList.add("active"),document.body.style.overflow="hidden",setTimeout((()=>{n.classList.add("visible")}),50)}(o)})))})),o.addEventListener("click",a),r.addEventListener("click",(e=>{e.stopPropagation(),i("next")})),s.addEventListener("click",(e=>{e.stopPropagation(),i("prev")})),t.addEventListener("click",(e=>{(e.target===t||e.target.classList.contains("lightbox-content"))&&a()})),document.addEventListener("keydown",(e=>{t.classList.contains("active")&&("Escape"===e.key&&a(),"ArrowRight"===e.key&&i("next"),"ArrowLeft"===e.key&&i("prev"))}));let d=0,m=0;t.addEventListener("touchstart",(e=>{d=e.changedTouches[0].screenX}),{passive:!0}),t.addEventListener("touchend",(e=>{m=e.changedTouches[0].screenX,function(){const e=50;m<d-e&&i("next");m>d+e&&i("prev")}()}),{passive:!0})}));